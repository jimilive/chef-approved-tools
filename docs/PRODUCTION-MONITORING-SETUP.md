# Production Monitoring Setup Guide

This guide covers setting up error tracking and 404 monitoring for your production site.

## 1. Error Tracking with Sentry (Recommended)

Sentry is free for small projects and catches JavaScript errors in production.

### Setup Steps:

1. **Create Sentry Account**
   - Go to https://sentry.io
   - Sign up (free tier: 5,000 errors/month)
   - Create a new project → Select "Next.js"

2. **Install Sentry**
   ```bash
   npm install @sentry/nextjs
   npx @sentry/wizard@latest -i nextjs
   ```

3. **Configure (Auto-generated by wizard)**
   - `sentry.client.config.ts` - Client-side error tracking
   - `sentry.server.config.ts` - Server-side error tracking
   - `sentry.edge.config.ts` - Edge runtime tracking

4. **Add to `.env.local`**
   ```bash
   NEXT_PUBLIC_SENTRY_DSN=your_sentry_dsn_here
   SENTRY_ORG=your_org
   SENTRY_PROJECT=your_project
   ```

5. **Test It Works**
   ```javascript
   // Add this to any page temporarily
   <button onClick={() => {
     throw new Error('Test Sentry Error!')
   }}>
     Test Error
   </button>
   ```

### What You'll Get:

- **Real-time alerts** when errors occur
- **Stack traces** showing exact line of code
- **User context** (browser, OS, etc.)
- **Error frequency** tracking
- **Email/Slack notifications** for critical errors

---

## 2. 404 Monitoring

### Option A: Google Search Console (Free, Built-in)

**Already set up!** Just check regularly:

1. Go to https://search.google.com/search-console
2. Navigate to "Coverage" → "Not found (404)"
3. See which URLs users tried to access
4. Add redirects for common 404s

**Set up alerts:**
- Search Console → Settings → Email notifications
- Enable "Site issues" notifications

### Option B: Netlify Analytics (Paid but Powerful)

If you're on Netlify:

1. **Enable Netlify Analytics** ($9/month)
   - Dashboard → Analytics → Enable
   - Get server-side tracking (no JavaScript needed)

2. **View 404s**
   - Analytics → Top 404s
   - Shows which pages users hit that don't exist

3. **Set up Notifications**
   - Netlify → Site settings → Build & deploy → Deploy notifications
   - Add Slack/Email webhook for failed deploys

### Option C: Custom 404 Tracking (Free)

Add this to your `app/not-found.tsx`:

```typescript
'use client'

import { useEffect } from 'react'
import { usePathname } from 'next/navigation'

export default function NotFound() {
  const pathname = usePathname()

  useEffect(() => {
    // Log to your analytics
    if (typeof window !== 'undefined' && window.gtag) {
      window.gtag('event', 'page_not_found', {
        page_path: pathname,
        event_category: 'Error',
        event_label: '404',
      })
    }

    // Optional: Send to your own API
    fetch('/api/log-404', {
      method: 'POST',
      body: JSON.stringify({ path: pathname }),
    }).catch(() => {}) // Fail silently
  }, [pathname])

  return (
    <div className="min-h-screen flex items-center justify-center">
      <div className="text-center">
        <h1 className="text-4xl font-bold mb-4">404 - Page Not Found</h1>
        <p className="text-gray-600 mb-8">
          The page you're looking for doesn't exist.
        </p>
        <a
          href="/"
          className="bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700"
        >
          Go Home
        </a>
      </div>
    </div>
  )
}
```

Then view 404s in Google Analytics:
- Events → page_not_found

---

## 3. Performance Monitoring

### Core Web Vitals Tracking (Already Setup)

You already have `@vercel/analytics` installed. To view:

1. **Vercel Dashboard** (if deployed on Vercel)
   - View Core Web Vitals automatically
   - See LCP, FID, CLS scores

2. **Google Search Console**
   - Core Web Vitals report
   - Shows slow pages

3. **Add Real User Monitoring (RUM)**

Add to `app/layout.tsx`:

```typescript
import { Analytics } from '@vercel/analytics/react'
import { SpeedInsights } from '@vercel/speed-insights/next'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <Analytics />
        <SpeedInsights />
      </body>
    </html>
  )
}
```

Install if needed:
```bash
npm install @vercel/speed-insights
```

---

## 4. Uptime Monitoring (Optional)

Track if your site goes down:

### Option A: UptimeRobot (Free)

1. Go to https://uptimerobot.com
2. Sign up (free: 50 monitors)
3. Add monitor:
   - Type: HTTP(S)
   - URL: https://www.chefapprovedtools.com
   - Interval: 5 minutes
4. Set up email/SMS alerts

### Option B: Better Uptime (More Features)

1. https://betteruptime.com
2. Free tier: 10 monitors
3. More advanced features than UptimeRobot

---

## 5. Recommended Alert Setup

### Critical (Immediate Action Required):
- [ ] Sentry errors > 10/hour
- [ ] Site down (UptimeRobot)
- [ ] Build failed (Netlify/Vercel)

### High Priority (Check Daily):
- [ ] 404 errors (Search Console)
- [ ] New Sentry errors
- [ ] Core Web Vitals degradation

### Medium Priority (Check Weekly):
- [ ] Sentry error trends
- [ ] Top 404s
- [ ] Performance trends

---

## 6. Dashboard Checklist

Create a monitoring routine:

**Daily (5 minutes):**
- [ ] Check Sentry for new errors
- [ ] Check deployment status

**Weekly (15 minutes):**
- [ ] Review Search Console 404s
- [ ] Check Core Web Vitals
- [ ] Review error trends

**Monthly (30 minutes):**
- [ ] Analyze top errors
- [ ] Fix recurring 404s
- [ ] Review performance metrics

---

## Quick Implementation Priority:

**Do Now (30 minutes):**
1. ✅ Set up Search Console 404 alerts
2. ✅ Add custom 404 tracking to Google Analytics
3. ✅ Enable UptimeRobot monitoring

**Do This Week (1 hour):**
1. Install Sentry
2. Test error tracking works
3. Set up alert thresholds

**Optional (Later):**
1. Add Real User Monitoring
2. Set up advanced monitoring dashboards
3. Integrate with Slack

---

## Cost Breakdown:

| Service | Cost | What You Get |
|---------|------|--------------|
| Sentry | Free (5k errors/mo) | Error tracking |
| Google Search Console | Free | SEO + 404 monitoring |
| UptimeRobot | Free (50 monitors) | Uptime monitoring |
| Google Analytics | Free | Custom 404 tracking |
| **Total** | **$0/month** | **Full monitoring** |

Optional paid upgrades:
- Netlify Analytics: $9/month
- Sentry Pro: $26/month (50k errors)
- Better Uptime: $20/month (advanced features)

---

## Testing Your Monitoring

After setup, test everything works:

```bash
# Test error tracking
# Visit /test-error page (create temp page that throws error)

# Test 404 tracking
# Visit /this-page-does-not-exist

# Test uptime monitoring
# Wait for UptimeRobot to ping your site

# Test build failure alerts
# Push broken code (then revert)
```

---

## Need Help?

- Sentry Docs: https://docs.sentry.io/platforms/javascript/guides/nextjs/
- Next.js Monitoring: https://nextjs.org/docs/app/building-your-application/optimizing/analytics
- Vercel Analytics: https://vercel.com/docs/analytics
